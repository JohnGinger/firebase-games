import{createContext as e,useState as a,useContext as t,useEffect as r,Children as n,cloneElement as l}from"react";import o from"firebase/app";import{useSearchParam as m}from"react-use";import"firebase/database";import s from"oboe";const i=e(null),u=({children:e,firebaseConfig:a})=>(o.apps.length||o.initializeApp(a),h(i.Provider,{value:o},e));function p(e){for(let a=e.length-1;a>0;a--){const t=Math.floor(Math.random()*(a+1));[e[a],e[t]]=[e[t],e[a]]}return e}const y=require("./adjectives.data"),d=require("./nouns.data");require("./intro.scss");var c=({playerName:e,setPlayerName:a,setGameId:t,onStart:r,gameIntro:n})=>h("intro-block",null,h("h2",null,"Welcome"),n,h(g,{playerName:e,setPlayerName:a,setGameId:t,onStart:r}));const g=({playerName:e,setPlayerName:n,setGameId:l})=>{const[o,m]=a(""),[u,c]=a(!1),[g,f]=a([]),[b,v]=a([]),[N,S]=a(0),I=t(i),C=()=>{""!==o&&""!==e?Promise.resolve().then(()=>{c(!0)}).then(()=>I.database().ref(`/${o}/players`)).then(a=>a.push({name:e})).then(()=>l(o)):alert("You need both a name and gameId")};return r(()=>{s(y).done(function(e){f(p(e))}).fail(function(e){console.warn(e)}),s(d).done(function(e){v(p(e))}).fail(function(e){console.warn(e)})},[]),h(Fragment,null,h("input",{type:"text",placeholder:"Your name",value:e,onChange:e=>n(e.target.value)}),h("input",{type:"text",placeholder:"Enter the game code",value:o,onChange:e=>m(e.target.value),onKeyPress:e=>{"Enter"==e.key&&C()}}),!u&&h(Fragment,null,h("button",{onClick:()=>(()=>{const e=g[N],a=b[N];S(N+1),m(`${e}-${a}`)})()},"Suggest random game code"),h("button",{onClick:()=>C()},"Play!")))},f=({gameState:e,gameRef:a,playerName:t,onStart:r})=>e.players?h("players-list",null,h("h2",null,"Waiting to play"),Object.entries(e.players).map(([r,n])=>h("label",{key:n.name},h("player-name",null,n.name," is ",n.ready?"ready":"not ready"),n.name===t&&h("button",{onClick:()=>(t=>{let r=e.players;r[t].ready=!r[t].ready,a.update({players:r})})(r)},"Toggle if Ready"))),h("button",{onClick:()=>{Object.values(e.players).some(e=>!e.ready)?alert("Someone isn't ready"):r({gameRef:a,gameState:e,playerName:t})},disabled:Object.values(e.players).some(e=>!e.ready)},"Start Game")):h("players-list",null," No players yet ");var b=({gameId:e,playerName:o,children:m,onStart:s})=>{const u=t(i),[p,y]=a({}),[d,c]=a();return r(()=>{var a=u.database().ref(`/${e}/`);c(a),a.on("value",function(e){y(e.val())})},[]),h("game-container",null,h("game-title",null,"Game Id - ",e," - playing as ",o," ",h("a",{href:"/"},"New Game")),p.active?n.map(m,e=>l(e,{gameState:p,gameRef:d,playerName:o})):h(f,{gameState:p,gameRef:d,playerName:o,onStart:s}))};export default({children:e,onStart:t=(()=>{}),gameIntro:r,firebaseConfig:n})=>{const[l,o]=a(m("game")||""),[s,i]=a(m("name")||"");return h(u,{firebaseConfig:n},l?h(b,{gameId:l,playerName:s,onStart:t},e):h(c,{playerName:s,setPlayerName:i,setGameId:o,gameIntro:r}))};
//# sourceMappingURL=index.modern.js.map

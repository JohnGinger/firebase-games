function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var a=require("react"),t=(e(a),e(require("firebase/app"))),n=require("react-use");require("firebase/database");var r=e(require("oboe")),u=a.createContext(null),o=function(e){var a=e.children;return t.apps.length||t.initializeApp(e.firebaseConfig),h(u.Provider,{value:t},a)};function l(e){for(var a=e.length-1;a>0;a--){var t=Math.floor(Math.random()*(a+1)),n=[e[t],e[a]];e[a]=n[0],e[t]=n[1]}return e}var i=require("./adjectives.data"),s=require("./nouns.data");require("./intro.scss");var c=function(e){var a=e.playerName,t=e.setPlayerName,n=e.setGameId,r=e.onStart,u=e.gameIntro;return h("intro-block",null,h("h2",null,"Welcome"),u,h(m,{playerName:a,setPlayerName:t,setGameId:n,onStart:r}))},m=function(e){var t=e.playerName,n=e.setPlayerName,o=e.setGameId,c=a.useState(""),m=c[0],f=c[1],d=a.useState(!1),y=d[0],p=d[1],g=a.useState([]),v=g[0],S=g[1],b=a.useState([]),N=b[0],C=b[1],I=a.useState(0),P=I[0],q=I[1],k=a.useContext(u),G=function(){""!==m&&""!==t?Promise.resolve().then(function(){p(!0)}).then(function(){return k.database().ref("/"+m+"/players")}).then(function(e){return e.push({name:t})}).then(function(){return o(m)}):alert("You need both a name and gameId")};return a.useEffect(function(){r(i).done(function(e){S(l(e))}).fail(function(e){console.warn(e)}),r(s).done(function(e){C(l(e))}).fail(function(e){console.warn(e)})},[]),h(Fragment,null,h("input",{type:"text",placeholder:"Your name",value:t,onChange:function(e){return n(e.target.value)}}),h("input",{type:"text",placeholder:"Enter the game code",value:m,onChange:function(e){return f(e.target.value)},onKeyPress:function(e){"Enter"==e.key&&G()}}),!y&&h(Fragment,null,h("button",{onClick:function(){return e=v[P],a=N[P],q(P+1),void f(e+"-"+a);var e,a}},"Suggest random game code"),h("button",{onClick:function(){return G()}},"Play!")))},f=function(e){var a=e.gameState,t=e.gameRef,n=e.playerName,r=e.onStart;return a.players?h("players-list",null,h("h2",null,"Waiting to play"),Object.entries(a.players).map(function(e){var r=e[0],u=e[1];return h("label",{key:u.name},h("player-name",null,u.name," is ",u.ready?"ready":"not ready"),u.name===n&&h("button",{onClick:function(){return(n=a.players)[e=r].ready=!n[e].ready,void t.update({players:n});var e,n}},"Toggle if Ready"))}),h("button",{onClick:function(){Object.values(a.players).some(function(e){return!e.ready})?alert("Someone isn't ready"):r({gameRef:t,gameState:a,playerName:n})},disabled:Object.values(a.players).some(function(e){return!e.ready})},"Start Game")):h("players-list",null," No players yet ")},d=function(e){var t=e.gameId,n=e.playerName,r=e.children,o=e.onStart,l=a.useContext(u),i=a.useState({}),s=i[0],c=i[1],m=a.useState(),d=m[0],y=m[1];return a.useEffect(function(){var e=l.database().ref("/"+t+"/");y(e),e.on("value",function(e){c(e.val())})},[]),h("game-container",null,h("game-title",null,"Game Id - ",t," - playing as ",n," ",h("a",{href:"/"},"New Game")),s.active?a.Children.map(r,function(e){return a.cloneElement(e,{gameState:s,gameRef:d,playerName:n})}):h(f,{gameState:s,gameRef:d,playerName:n,onStart:o}))};module.exports=function(e){var t=e.children,r=e.onStart,u=void 0===r?function(){}:r,l=e.gameIntro,i=e.firebaseConfig,s=a.useState(n.useSearchParam("game")||""),m=s[0],f=s[1],y=a.useState(n.useSearchParam("name")||""),p=y[0],g=y[1];return h(o,{firebaseConfig:i},m?h(d,{gameId:m,playerName:p,onStart:u},t):h(c,{playerName:p,setPlayerName:g,setGameId:f,gameIntro:l}))};
//# sourceMappingURL=index.js.map

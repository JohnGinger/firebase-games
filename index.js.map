{"version":3,"file":"index.js","sources":["src/firebase.js","src/shuffle.js","src/Intro.jsx","src/Lobby.jsx","src/GameAndLobby.jsx","src/GameProvider.jsx"],"sourcesContent":["import React, { createContext } from \"react\";\nimport app from \"firebase/app\";\n\nconst FirebaseContext = createContext(null);\nexport { FirebaseContext };\n\nconst FirebaseProvider = ({ children, firebaseConfig }) => {\n  if (!app.apps.length) {\n    app.initializeApp(firebaseConfig);\n  }\n\n  return (\n    <FirebaseContext.Provider value={app}>{children}</FirebaseContext.Provider>\n  );\n};\nexport { FirebaseProvider };\n","function shuffle(a) {\n  for (let i = a.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [a[i], a[j]] = [a[j], a[i]];\n  }\n  return a;\n}\nexport default shuffle;\n","import React, { useState, useContext, useEffect } from \"react\";\nimport { FirebaseContext } from \"./firebase\";\nimport shuffle from \"./shuffle\";\n\nimport \"firebase/database\";\n\nimport oboe from \"oboe\";\nconst adjectives = require(\"./adjectives.data\");\nconst nouns = require(\"./nouns.data\");\n\nrequire(\"./intro.scss\");\n\nexport default ({\n  playerName,\n  setPlayerName,\n  setGameId,\n  onStart,\n  gameIntro,\n}) => (\n  <intro-block>\n    <h2>Welcome</h2>\n    {gameIntro}\n    <JoinGame\n      playerName={playerName}\n      setPlayerName={setPlayerName}\n      setGameId={setGameId}\n      onStart={onStart}\n    />\n  </intro-block>\n);\n\nconst JoinGame = ({\n  playerName,\n  setPlayerName,\n  setGameId: setGame,\n  onStart,\n}) => {\n  const [gameId, setGameId] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [adjectivesList, setAdjectivesList] = useState([]);\n  const [nounList, setNounList] = useState([]);\n  const [wordIndex, setWordIndex] = useState(0);\n\n  const firebase = useContext(FirebaseContext);\n\n  const addGame = () => {\n    if (gameId === \"\" || playerName === \"\") {\n      alert(\"You need both a name and gameId\");\n      return;\n    }\n    Promise.resolve()\n      .then(() => {\n        setLoading(true);\n      })\n      .then(() => {\n        return firebase.database().ref(`/${gameId}/players`);\n      })\n      .then((gameRef) => gameRef.push({ name: playerName }))\n      .then(() => {\n        return setGame(gameId);\n      });\n  };\n\n  useEffect(() => {\n    oboe(adjectives)\n      .done(function (words) {\n        setAdjectivesList(shuffle(words));\n      })\n      .fail(function (e) {\n        console.warn(e);\n      });\n    oboe(nouns)\n      .done(function (words) {\n        setNounList(shuffle(words));\n      })\n      .fail(function (e) {\n        console.warn(e);\n      });\n  }, []);\n\n  const getRandomCode = () => {\n    const wordOne = adjectivesList[wordIndex];\n    const wordTwo = nounList[wordIndex];\n    setWordIndex(wordIndex + 1);\n    setGameId(`${wordOne}-${wordTwo}`);\n  };\n\n  return (\n    <>\n      <input\n        type=\"text\"\n        placeholder=\"Your name\"\n        value={playerName}\n        onChange={(e) => setPlayerName(e.target.value)}\n      ></input>\n      <input\n        type=\"text\"\n        placeholder=\"Enter the game code\"\n        value={gameId}\n        onChange={(e) => setGameId(e.target.value)}\n        onKeyPress={(e) => {\n          if (e.key == \"Enter\") {\n            addGame();\n          }\n        }}\n      ></input>\n      {!loading && (\n        <>\n          <button onClick={() => getRandomCode()}>\n            Suggest random game code\n          </button>\n          <button onClick={() => addGame()}>Play!</button>\n        </>\n      )}\n    </>\n  );\n};\n","import React from \"react\";\n\nconst Lobby = ({ gameState, gameRef, playerName, onStart }) => {\n  const startGame = () => {\n    if (Object.values(gameState.players).some((x) => !x.ready)) {\n      alert(\"Someone isn't ready\");\n      return;\n    }\n    onStart({ gameRef, gameState, playerName });\n  };\n\n  const toggleReady = (playerId) => {\n    let newPlayers = gameState.players;\n    newPlayers[playerId].ready = !newPlayers[playerId].ready;\n    gameRef.update({\n      players: newPlayers,\n    });\n  };\n\n  if (!gameState.players) {\n    return <players-list> No players yet </players-list>;\n  }\n\n  return (\n    <players-list>\n      <h2>Waiting to play</h2>\n      {Object.entries(gameState.players).map(([key, player]) => (\n        <label key={player.name}>\n          <player-name>\n            {player.name} is {player.ready ? \"ready\" : \"not ready\"}\n          </player-name>\n          {player.name === playerName && (\n            <button onClick={() => toggleReady(key)}>Toggle if Ready</button>\n          )}\n        </label>\n      ))}\n      <button\n        onClick={() => startGame()}\n        disabled={Object.values(gameState.players).some((x) => !x.ready)}\n      >\n        Start Game\n      </button>\n    </players-list>\n  );\n};\n\nexport default Lobby;\n","import React, {\n  useState,\n  useContext,\n  useEffect,\n  Children,\n  cloneElement,\n} from \"react\";\nimport { FirebaseContext } from \"./firebase\";\nimport \"firebase/database\";\nimport Lobby from \"./Lobby\";\n\nexport default ({ gameId, playerName, children, onStart }) => {\n  const firebase = useContext(FirebaseContext);\n  const [gameState, setGameState] = useState({});\n  const [gameRef, setGameRef] = useState();\n\n  useEffect(() => {\n    var gameRef = firebase.database().ref(`/${gameId}/`);\n    setGameRef(gameRef);\n    gameRef.on(\"value\", function (snapshot) {\n      setGameState(snapshot.val());\n    });\n  }, []);\n\n  return (\n    <game-container>\n      <game-title>\n        Game Id - {gameId} - playing as {playerName} <a href=\"/\">New Game</a>\n      </game-title>\n      {gameState.active ? (\n        Children.map(children, (child) =>\n          cloneElement(child, { gameState, gameRef, playerName })\n        )\n      ) : (\n        <Lobby\n          gameState={gameState}\n          gameRef={gameRef}\n          playerName={playerName}\n          onStart={onStart}\n        />\n      )}\n    </game-container>\n  );\n};\n","import React, { useState } from \"react\";\nimport { FirebaseProvider } from \"./firebase\";\nimport { useSearchParam } from \"react-use\";\nimport Intro from \"./Intro\";\nimport GameAndLobby from \"./GameAndLobby\";\n\nexport default ({\n  children,\n  onStart = () => {},\n  gameIntro,\n  firebaseConfig,\n}) => {\n  const [gameId, setGameId] = useState(useSearchParam(\"game\") || \"\");\n  const [playerName, setPlayerName] = useState(useSearchParam(\"name\") || \"\");\n\n  return (\n    <FirebaseProvider firebaseConfig={firebaseConfig}>\n      {gameId ? (\n        <GameAndLobby gameId={gameId} playerName={playerName} onStart={onStart}>\n          {children}\n        </GameAndLobby>\n      ) : (\n        <Intro\n          playerName={playerName}\n          setPlayerName={setPlayerName}\n          setGameId={setGameId}\n          gameIntro={gameIntro}\n        />\n      )}\n    </FirebaseProvider>\n  );\n};\n"],"names":["FirebaseContext","createContext","FirebaseProvider","children","app","apps","length","initializeApp","firebaseConfig","Provider","value","shuffle","a","i","j","Math","floor","random","adjectives","require","nouns","playerName","setPlayerName","setGameId","onStart","gameIntro","h","JoinGame","setGame","useState","gameId","loading","setLoading","adjectivesList","setAdjectivesList","nounList","setNounList","wordIndex","setWordIndex","firebase","useContext","addGame","Promise","resolve","then","database","ref","gameRef","push","name","alert","useEffect","oboe","done","words","fail","e","console","warn","type","placeholder","onChange","target","onKeyPress","key","onClick","wordOne","wordTwo","Lobby","gameState","players","Object","entries","map","player","ready","newPlayers","playerId","update","values","some","x","disabled","setGameState","setGameRef","on","snapshot","val","href","active","Children","child","cloneElement","useSearchParam","GameAndLobby","Intro"],"mappings":"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"}
!function(e,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a(require("react"),require("firebase/app"),require("react-use"),require("firebase/database"),require("oboe")):"function"==typeof define&&define.amd?define(["react","firebase/app","react-use","firebase/database","oboe"],a):(e=e||self).firebaseGames=a(e.react,e.app,e.reactUse,0,e.oboe)}(this,function(e,a,t,n,r){a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;var o=e.createContext(null),u=function(e){var t=e.children;return a.apps.length||a.initializeApp(e.firebaseConfig),h(o.Provider,{value:a},t)};function l(e){for(var a=e.length-1;a>0;a--){var t=Math.floor(Math.random()*(a+1)),n=[e[t],e[a]];e[a]=n[0],e[t]=n[1]}return e}var i=require("./adjectives.data"),s=require("./nouns.data");require("./intro.scss");var c=function(e){var a=e.playerName,t=e.setPlayerName,n=e.setGameId,r=e.onStart,o=e.gameIntro;return h("intro-block",null,h("h2",null,"Welcome"),o,h(f,{playerName:a,setPlayerName:t,setGameId:n,onStart:r}))},f=function(a){var t=a.playerName,n=a.setPlayerName,u=a.setGameId,c=e.useState(""),f=c[0],m=c[1],d=e.useState(!1),p=d[0],y=d[1],g=e.useState([]),v=g[0],b=g[1],S=e.useState([]),N=S[0],C=S[1],P=e.useState(0),I=P[0],q=P[1],G=e.useContext(o),j=function(){""!==f&&""!==t?Promise.resolve().then(function(){y(!0)}).then(function(){return G.database().ref("/"+f+"/players")}).then(function(e){return e.push({name:t})}).then(function(){return u(f)}):alert("You need both a name and gameId")};return e.useEffect(function(){r(i).done(function(e){b(l(e))}).fail(function(e){console.warn(e)}),r(s).done(function(e){C(l(e))}).fail(function(e){console.warn(e)})},[]),h(Fragment,null,h("input",{type:"text",placeholder:"Your name",value:t,onChange:function(e){return n(e.target.value)}}),h("input",{type:"text",placeholder:"Enter the game code",value:f,onChange:function(e){return m(e.target.value)},onKeyPress:function(e){"Enter"==e.key&&j()}}),!p&&h(Fragment,null,h("button",{onClick:function(){return e=v[I],a=N[I],q(I+1),void m(e+"-"+a);var e,a}},"Suggest random game code"),h("button",{onClick:function(){return j()}},"Play!")))},m=function(e){var a=e.gameState,t=e.gameRef,n=e.playerName,r=e.onStart;return a.players?h("players-list",null,h("h2",null,"Waiting to play"),Object.entries(a.players).map(function(e){var r=e[0],o=e[1];return h("label",{key:o.name},h("player-name",null,o.name," is ",o.ready?"ready":"not ready"),o.name===n&&h("button",{onClick:function(){return(n=a.players)[e=r].ready=!n[e].ready,void t.update({players:n});var e,n}},"Toggle if Ready"))}),h("button",{onClick:function(){Object.values(a.players).some(function(e){return!e.ready})?alert("Someone isn't ready"):r({gameRef:t,gameState:a,playerName:n})},disabled:Object.values(a.players).some(function(e){return!e.ready})},"Start Game")):h("players-list",null," No players yet ")},d=function(a){var t=a.gameId,n=a.playerName,r=a.children,u=a.onStart,l=e.useContext(o),i=e.useState({}),s=i[0],c=i[1],f=e.useState(),d=f[0],p=f[1];return e.useEffect(function(){var e=l.database().ref("/"+t+"/");p(e),e.on("value",function(e){c(e.val())})},[]),h("game-container",null,h("game-title",null,"Game Id - ",t," - playing as ",n," ",h("a",{href:"/"},"New Game")),s.active?e.Children.map(r,function(a){return e.cloneElement(a,{gameState:s,gameRef:d,playerName:n})}):h(m,{gameState:s,gameRef:d,playerName:n,onStart:u}))};return function(a){var n=a.children,r=a.onStart,o=void 0===r?function(){}:r,l=a.gameIntro,i=a.firebaseConfig,s=e.useState(t.useSearchParam("game")||""),f=s[0],m=s[1],p=e.useState(t.useSearchParam("name")||""),y=p[0],g=p[1];return h(u,{firebaseConfig:i},f?h(d,{gameId:f,playerName:y,onStart:o},n):h(c,{playerName:y,setPlayerName:g,setGameId:m,gameIntro:l}))}});
//# sourceMappingURL=index.umd.js.map
